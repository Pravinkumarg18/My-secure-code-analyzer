[
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 120,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// 11. Unsafe use of exec() with user input",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 124,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// Unsafe execution of user input",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 322,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "<li>exec - exec() Injection</li>",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-WEAK-HASH",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 54,
    "severity": "HIGH",
    "category": "Cryptography",
    "message": "Weak hashing algorithm used.",
    "suggestion": "Use password_hash() with bcrypt or Argon2.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "CWE-327,CWE-328",
    "snippet": "if (md5($password) === $stored_hash) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-WEAK-HASH",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 114,
    "severity": "HIGH",
    "category": "Cryptography",
    "message": "Weak hashing algorithm used.",
    "suggestion": "Use password_hash() with bcrypt or Argon2.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "CWE-327,CWE-328",
    "snippet": "if (md5($password) == $stored_hash) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-MT-RAND-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 163,
    "severity": "MEDIUM",
    "category": "Weak Randomness",
    "message": "Use of mt_rand() for security tokens is unsafe.",
    "suggestion": "Use random_int() or random_bytes() instead.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "CWE-338",
    "snippet": "$token = mt_rand(); // Not cryptographically secure",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SESSION-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 67,
    "severity": "MEDIUM",
    "category": "Session Management",
    "message": "Cookie set without Secure/HttpOnly/SameSite flags.",
    "suggestion": "Always set cookies with HttpOnly, Secure, and SameSite=strict.",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "setcookie(\"user_data\", base64_encode(serialize($_SESSION)), time()+3600, \"/\", \"\", false, false);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-XXE-BILLION-LAUGHS-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 136,
    "severity": "CRITICAL",
    "category": "Xxe / Billion Laughs",
    "message": "XML parsed with LIBXML_NOENT \u2192 XXE / Billion Laughs risk.",
    "suggestion": "Disable external entity expansion (do not use LIBXML_NOENT).",
    "owasp": "",
    "cwe": "",
    "snippet": "$doc->loadXML($xml, LIBXML_NOENT);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-UNSAFE-EXTRACT-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 171,
    "severity": "HIGH",
    "category": "Unsafe Extract()",
    "message": "extract() with EXTR_SKIP \u2192 Unsafe variable overwrite.",
    "suggestion": "Avoid EXTR_SKIP; explicitly define variables.",
    "owasp": "",
    "cwe": "",
    "snippet": "// 16. Unsafe use of extract() with EXTR_SKIP",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-PASSWORD-IN-URL-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 19,
    "severity": "HIGH",
    "category": "Password In Url",
    "message": "Password passed in URL \u2192 Information exposure.",
    "suggestion": "Transmit passwords in POST requests only.",
    "owasp": "",
    "cwe": "",
    "snippet": "$password = $_GET['password'];",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-PASSWORD-IN-URL-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 205,
    "severity": "HIGH",
    "category": "Password In Url",
    "message": "Password passed in URL \u2192 Information exposure.",
    "suggestion": "Transmit passwords in POST requests only.",
    "owasp": "",
    "cwe": "",
    "snippet": "$password = $_GET['password']; // Password in URL - visible in logs",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-HEUR-021",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 74,
    "severity": "MEDIUM",
    "category": "Superglobals",
    "message": "Use of PHP superglobal $_REQUEST detected.",
    "suggestion": "Use $_GET or $_POST explicitly and validate input.",
    "owasp": "A01:2021-BrokenAccessControl",
    "cwe": "",
    "snippet": "foreach ($_REQUEST as $key => $value) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-HEUR-023",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 64,
    "severity": "LOW",
    "category": "Session Handling",
    "message": "Session start detected, ensure secure flags are set.",
    "suggestion": "Use secure session cookies (HttpOnly, Secure, SameSite).",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "session_start();",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-EXEC-AST-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 125,
    "severity": "CRITICAL",
    "category": "Command Injection",
    "message": "exec() called with user input \u2192 Command Injection.",
    "suggestion": "Avoid exec(); use built-in APIs.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "exec(\"ls -la \" . $command, $output);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-PREG-REPLACE-AST-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 147,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "preg_replace with /e modifier executes code \u2192 RCE risk.",
    "suggestion": "Use preg_replace_callback instead of /e.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "$result = preg_replace('/\\{(\\w+)\\}/e', '$data[\"$1\"]', $template);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-HEADER-TAINT-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 12,
    "severity": "CRITICAL",
    "category": "Http Response Splitting",
    "message": "header() with user input may lead to HTTP Response Splitting.",
    "suggestion": "Never pass raw user input to header().",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "header(\"Location: \" . $redirect);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-HEADER-TAINT-001",
    "file": "sample.zip/sample\\deepseek_php.php",
    "line": 44,
    "severity": "CRITICAL",
    "category": "Http Response Splitting",
    "message": "header() with user input may lead to HTTP Response Splitting.",
    "suggestion": "Never pass raw user input to header().",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "header(\"Content-Disposition: attachment; filename=\" . $filename);",
    "detected_by": "Context-AST"
  },
  {
    "id": "JAVA-RUNTIME-EXEC-REGEX",
    "file": "sample.zip/sample\\sample.java",
    "line": 81,
    "severity": "CRITICAL",
    "category": "Command Injection",
    "message": "Runtime.getRuntime().exec() detected.",
    "suggestion": "Avoid direct exec(); use ProcessBuilder with validated args.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-78",
    "snippet": "Process p = Runtime.getRuntime().exec(cmd);",
    "detected_by": "Regex"
  },
  {
    "id": "JAVA-STACKTRACE",
    "file": "sample.zip/sample\\sample.java",
    "line": 144,
    "severity": "MEDIUM",
    "category": "Information Disclosure",
    "message": "Stack trace leakage.",
    "suggestion": "Log securely without exposing stack traces.",
    "owasp": "A09:2021-SecurityLoggingandMonitoringFailures",
    "cwe": "CWE-209",
    "snippet": "e.printStackTrace();",
    "detected_by": "Regex"
  },
  {
    "id": "JAVA-SQL-HEURISTIC",
    "file": "sample.zip/sample\\sample.java",
    "line": 98,
    "severity": "HIGH",
    "category": "Sql Injection",
    "message": "Concatenating SQL queries with user input is dangerous.",
    "suggestion": "Use PreparedStatement with bind parameters.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-89",
    "snippet": "String sql = \"SELECT * FROM users WHERE username = '\" + user + \"'\";",
    "detected_by": "Heuristic"
  },
  {
    "id": "JAVA-DESERIALIZE-AST",
    "file": "sample.zip/sample\\sample.java",
    "line": 123,
    "severity": "HIGH",
    "category": "Insecure Deserialization",
    "message": "ObjectInputStream.readObject() detected.",
    "suggestion": "Avoid deserialization of untrusted data.",
    "owasp": "A08:2021-SoftwareandDataIntegrityFailures",
    "cwe": "CWE-502",
    "snippet": "Object obj = ois.readObject();",
    "detected_by": "AST"
  },
  {
    "id": "JS-EVAL-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 41,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "Use of eval() can lead to code injection.",
    "suggestion": "Avoid eval(); use JSON.parse or pre-defined function maps.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// VULN #5 - Unsafe eval (single occurrence)",
    "detected_by": "Regex"
  },
  {
    "id": "JS-EVAL-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 44,
    "severity": "CRITICAL",
    "category": "Code Injection",
    "message": "Use of eval() can lead to code execution.",
    "suggestion": "Avoid eval(); use safe parsers or functions.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "return eval(code);",
    "detected_by": "AST"
  },
  {
    "id": "JS-CHILD-PROCESS-EXEC",
    "file": "sample.zip/sample\\sample2.js",
    "line": 28,
    "severity": "CRITICAL",
    "category": "Command Execution",
    "message": "Use of child_process.exec() with user input may allow remote command execution.",
    "suggestion": "Use safer alternatives like execFile with strict input validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "child_process.exec(\"ping -c 1 \" + host, (err, stdout) => {",
    "detected_by": "Regex"
  },
  {
    "id": "JS-CHILD-PROCESS-EXEC",
    "file": "sample.zip/sample\\sample2.js",
    "line": 108,
    "severity": "CRITICAL",
    "category": "Command Execution",
    "message": "Use of child_process.exec() with user input may allow remote command execution.",
    "suggestion": "Use safer alternatives like execFile with strict input validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "child_process.exec(obj.cmd || \"\");",
    "detected_by": "Regex"
  },
  {
    "id": "JS-XSS-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 210,
    "severity": "CRITICAL",
    "category": "Cross-Site Scripting (Xss)",
    "message": "Potential DOM XSS: User input written directly to the DOM without sanitization.",
    "suggestion": "Avoid using document.write/innerHTML/outerHTML with untrusted input. Use textContent, setAttribute, or sanitize input with libraries like DOMPurify.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-79",
    "snippet": "container.innerHTML = userHtml;",
    "detected_by": "Context-AST"
  },
  {
    "id": "JS-WEAK-HASH",
    "file": "sample.zip/sample\\sample2.js",
    "line": 84,
    "severity": "HIGH",
    "category": "Cryptography",
    "message": "Weak hashing algorithm (MD5/SHA1) used.",
    "suggestion": "Use SHA-256, SHA-512, or SHA-3. For passwords, use bcrypt, scrypt, or Argon2 instead of general-purpose hashes.",
    "owasp": "A02:2021-CryptographicFailures,A03:2021-Injection",
    "cwe": "CWE-327,CWE-328,CWE-94",
    "snippet": "return crypto.createHash(\"md5\").update(password).digest(\"hex\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-WEAK-RNG-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 71,
    "severity": "MEDIUM",
    "category": "Weak Randomness",
    "message": "Weak randomness with Math.random()",
    "suggestion": "Use crypto.getRandomValues() instead.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "CWE-338",
    "snippet": "// VULN #9 - Insecure random token using Math.random (single occurrence)",
    "detected_by": "Regex"
  },
  {
    "id": "JS-WEAK-RNG-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 74,
    "severity": "MEDIUM",
    "category": "Weak Randomness",
    "message": "Weak randomness with Math.random()",
    "suggestion": "Use crypto.getRandomValues() instead.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "CWE-338",
    "snippet": "return Math.random().toString(36).slice(2);",
    "detected_by": "AST"
  },
  {
    "id": "JS-CONSOLE-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 29,
    "severity": "LOW",
    "category": "Information Disclosure",
    "message": "Console logging detected (informational).",
    "suggestion": "Remove console statements in production.",
    "owasp": "A09:2021-SecurityLoggingandMonitoringFailures",
    "cwe": "CWE-200",
    "snippet": "console.log(stdout || err);",
    "detected_by": "Heuristic"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 163,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection,A09:2021-SecurityLoggingandMonitoringFailures",
    "cwe": "CWE-200,CWE-532,CWE-94",
    "snippet": "console.log(\"Login attempt:\", username, password);",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 275,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection,A09:2021-SecurityLoggingandMonitoringFailures",
    "cwe": "CWE-200,CWE-94",
    "snippet": "console.log(\"vulnerable_30 server listening on http://localhost:9876\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-FUNCTION-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 155,
    "severity": "CRITICAL",
    "category": "Code Injection",
    "message": "Use of Function constructor is dangerous.",
    "suggestion": "Avoid Function(); use safer alternatives.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-95",
    "snippet": "const fn = new Function(code);",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 6,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "const http = require(\"http\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 7,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "const fs = require(\"fs\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 8,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "const child_process = require(\"child_process\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 9,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "const crypto = require(\"crypto\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 10,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "const url = require(\"url\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 123,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "res.setHeader(\"Set-Cookie\", \"auth_v16=\" + value + \"; Path=/\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 130,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "res.end(`${callback}(${JSON.stringify(data)})`);",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 137,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "http.get(targetUrl, (resp) => {",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 139,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "resp.on(\"data\", (chunk) => (body += chunk));",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 140,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "resp.on(\"end\", () => cb(null, body));",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 178,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "fs.writeFileSync(\"secrets/public_secret_v23.txt\", secretContent, { mode: 0o644 });",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 185,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "let v = parseInt(fs.readFileSync(\"counter_v24.txt\", \"utf8\") || \"0\", 10);",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 187,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "fs.writeFileSync(\"counter_v24.txt\", String(v));",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 202,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "return crypto.createHmac(\"sha1\", \"k26\").update(data).digest(\"hex\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 216,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "const items = fs.readdirSync(\".\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 217,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "res.end(items.join(\"\\n\"));",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 233,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "res.setHeader(\"X-Custom-Header\", value);",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 243,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "res.end(\"ping triggered\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 250,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "res.end(\"error\");",
    "detected_by": "AST"
  },
  {
    "id": "JS-SETTIMEOUT-AST-001",
    "file": "sample.zip/sample\\sample2.js",
    "line": 271,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "setTimeout called with a string \u2192 dynamic code execution like eval().",
    "suggestion": "Always pass a function reference or arrow function instead of a string.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "res.end(\"vulnerable_30 demo\");",
    "detected_by": "AST"
  },
  {
    "id": "PHP-EVAL-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 63,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "Use of eval() can lead to code injection.",
    "suggestion": "Avoid eval(); use safer alternatives.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "eval($_GET['code']);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 27,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "if (isset($_GET['ping'])) {",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-AST-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 107,
    "severity": "CRITICAL",
    "category": "Command Injection",
    "message": "system() called with user input \u2192 Command Injection.",
    "suggestion": "Avoid system(); use built-in APIs.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "class Test { public $cmd; function __wakeup(){ system($this->cmd); } }",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-WEAK-HASH",
    "file": "sample.zip/sample\\sample2.php",
    "line": 141,
    "severity": "HIGH",
    "category": "Cryptography",
    "message": "Weak hashing algorithm used.",
    "suggestion": "Use password_hash() with bcrypt or Argon2.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "CWE-327,CWE-328",
    "snippet": "$hash = md5($_POST['pwd']);",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-INFO-DISCLOSURE",
    "file": "sample.zip/sample\\sample2.php",
    "line": 104,
    "severity": "MEDIUM",
    "category": "Information Disclosure",
    "message": "Sensitive error information disclosure.",
    "suggestion": "Disable debug info in production.",
    "owasp": "A09:2021-SecurityLoggingandMonitoringFailures",
    "cwe": "CWE-209",
    "snippet": "phpinfo();",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-MYSQL-LEGACY-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 20,
    "severity": "HIGH",
    "category": "Sql Injection",
    "message": "Use of deprecated mysql_* API with untrusted input allows SQL Injection.",
    "suggestion": "Migrate to mysqli or PDO with prepared statements.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "$res = mysql_query(\"SELECT * FROM users WHERE id=$id\"); // vuln: SQLi",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-MYSQL-LEGACY-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 73,
    "severity": "HIGH",
    "category": "Sql Injection",
    "message": "Use of deprecated mysql_* API with untrusted input allows SQL Injection.",
    "suggestion": "Migrate to mysqli or PDO with prepared statements.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "mysql_query(\"UPDATE users SET email='{$_POST['email']}' WHERE id=1\");",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-MYSQL-LEGACY-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 92,
    "severity": "HIGH",
    "category": "Sql Injection",
    "message": "Use of deprecated mysql_* API with untrusted input allows SQL Injection.",
    "suggestion": "Migrate to mysqli or PDO with prepared statements.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "mysql_query(\"INSERT INTO users (username, password) VALUES ('$u','$p')\");",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-INCLUDE-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 32,
    "severity": "HIGH",
    "category": "File Inclusion",
    "message": "Dynamic include/require detected. May allow LFI/RFI.",
    "suggestion": "Never include user input in include/require paths. Use whitelists.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "if (isset($_GET['page'])) {",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-FILE-READ-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 44,
    "severity": "HIGH",
    "category": "Path Traversal",
    "message": "file_get_contents on user input may allow path traversal / arbitrary file read.",
    "suggestion": "Avoid using unvalidated input in file_get_contents.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "echo file_get_contents(\"uploads/\" . $file);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-FILE-READ-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 116,
    "severity": "HIGH",
    "category": "Path Traversal",
    "message": "file_get_contents on user input may allow path traversal / arbitrary file read.",
    "suggestion": "Avoid using unvalidated input in file_get_contents.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "$ctx = stream_context_create([\"ssl\"=>[\"verify_peer\"=>false]]);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-FILE-READ-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 134,
    "severity": "HIGH",
    "category": "Path Traversal",
    "message": "file_get_contents on user input may allow path traversal / arbitrary file read.",
    "suggestion": "Avoid using unvalidated input in file_get_contents.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "$b = file_get_contents(\"balance.txt\");",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-DESERIALIZATION",
    "file": "sample.zip/sample\\sample2.php",
    "line": 68,
    "severity": "CRITICAL",
    "category": "Insecure Deserialization",
    "message": "Untrusted unserialize() usage detected.",
    "suggestion": "Avoid unserialize(), use safe formats like JSON.",
    "owasp": "A08:2021-SoftwareIntegrityFailures,A08:2021-SoftwareandDataIntegrityFailures",
    "cwe": "CWE-502",
    "snippet": "$obj = unserialize($_POST['data']);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-MOVE-UPLOAD-TAINT-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 38,
    "severity": "CRITICAL",
    "category": "Insecure File Upload",
    "message": "move_uploaded_file() without validation allows arbitrary file upload.",
    "suggestion": "Validate file type, size, and use randomized safe paths.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "move_uploaded_file($_FILES['file']['tmp_name'], \"uploads/\" . $_FILES['file']['name']);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-AUTH-CHECK-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 101,
    "severity": "HIGH",
    "category": "Broken Access Control",
    "message": "Access control decision appears to be based on user input.",
    "suggestion": "Enforce server-side authorization using session or token checks.",
    "owasp": "A01:2021-BrokenAccessControl,A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "setcookie(\"auth\", $_GET['auth'] ?? \"none\");",
    "detected_by": "AST"
  },
  {
    "id": "PHP-SQLI-002",
    "file": "sample.zip/sample\\sample2.php",
    "line": 72,
    "severity": "CRITICAL",
    "category": "Sql Injection",
    "message": "Potential SQL injection vulnerability",
    "suggestion": "Use prepared statements or parameterized queries. Validate all inputs.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-89",
    "snippet": "if (isset($_POST['updateEmail'])) {",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-AUTH-CHECK-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 83,
    "severity": "HIGH",
    "category": "Broken Access Control",
    "message": "Access control decision appears to be based on user input.",
    "suggestion": "Enforce server-side authorization using session or token checks.",
    "owasp": "A01:2021-BrokenAccessControl",
    "cwe": "",
    "snippet": "if ($_GET['user'] == $admin_user && $_GET['pass'] == $admin_pass) {",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-HARDCODED-SECRET-002",
    "file": "sample.zip/sample\\sample2.php",
    "line": 110,
    "severity": "HIGH",
    "category": "Insecure Design",
    "message": "Hardcoded secret or token detected.",
    "suggestion": "Use environment variables or a secrets manager.",
    "owasp": "A04:2021-InsecureDesign",
    "cwe": "",
    "snippet": "$apiKey = \"SECRET-API-KEY-123\";",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-OUTDATED-MYSQL-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 14,
    "severity": "HIGH",
    "category": "Outdated Components",
    "message": "Use of deprecated mysql_connect() detected.",
    "suggestion": "Migrate to PDO or mysqli with prepared statements.",
    "owasp": "A06:2021-VulnerableandOutdatedComponents",
    "cwe": "",
    "snippet": "$conn = mysql_connect(\"localhost\", \"root\", \"root\");",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SSRF-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 117,
    "severity": "HIGH",
    "category": "Ssrf",
    "message": "Potential SSRF: fetching external URL without validation.",
    "suggestion": "Validate and whitelist remote URLs before requesting.",
    "owasp": "A05:2021-SecurityMisconfiguration,A10:2021-SSRF",
    "cwe": "",
    "snippet": "file_get_contents(\"https://untrusted-site.com/data\", false, $ctx);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-HEADER-TAINT-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 78,
    "severity": "CRITICAL",
    "category": "Http Response Splitting",
    "message": "header() with user input may lead to HTTP Response Splitting.",
    "suggestion": "Never pass raw user input to header().",
    "owasp": "A01:2021-BrokenAccessControl,A03:2021-Injection",
    "cwe": "",
    "snippet": "header(\"Location: \" . $_GET['url']);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-HEUR-023",
    "file": "sample.zip/sample\\sample2.php",
    "line": 53,
    "severity": "LOW",
    "category": "Session Handling",
    "message": "Session start detected, ensure secure flags are set.",
    "suggestion": "Use secure session cookies (HttpOnly, Secure, SameSite).",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "session_start();",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-SYSTEM-AST-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 28,
    "severity": "CRITICAL",
    "category": "Command Injection",
    "message": "system() called with user input \u2192 Command Injection.",
    "suggestion": "Avoid system(); use built-in APIs.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "system(\"ping -c 1 \" . $_GET['ping']);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-CTX-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 33,
    "severity": "CRITICAL",
    "category": "File Inclusion",
    "message": "File include/require uses untrusted input.",
    "suggestion": "Do not include files based on user input. Use whitelisted paths.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "include($_GET['page'] . \".php\");",
    "detected_by": "Context-AST"
  },
  {
    "id": "PHP-HEADER-TAINT-001",
    "file": "sample.zip/sample\\sample2.php",
    "line": 129,
    "severity": "CRITICAL",
    "category": "Http Response Splitting",
    "message": "header() with user input may lead to HTTP Response Splitting.",
    "suggestion": "Never pass raw user input to header().",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "header(\"X-Test: \" . $_GET['header']);",
    "detected_by": "Context-AST"
  },
  {
    "id": "PY-EVAL-REGEX",
    "file": "sample.zip/sample\\sample_python.py",
    "line": 8,
    "severity": "CRITICAL",
    "category": "Code Injection",
    "message": "Use of eval() can lead to code execution.",
    "suggestion": "Avoid eval(); use ast.literal_eval if parsing data.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-94",
    "snippet": "eval(user_input)   # VULN: PY-EVAL-REGEX + PY-EVAL-TAINT",
    "detected_by": "Regex"
  },
  {
    "id": "PY-DESERIALIZATION",
    "file": "sample.zip/sample\\sample_python.py",
    "line": 12,
    "severity": "CRITICAL",
    "category": "Insecure Deserialization",
    "message": "Untrusted pickle deserialization detected.",
    "suggestion": "Use safe serialization libraries (e.g., JSON).",
    "owasp": "A08:2021-SoftwareIntegrityFailures,A08:2021-SoftwareandDataIntegrityFailures",
    "cwe": "CWE-502",
    "snippet": "obj = pickle.load(f)  # VULN: PY-PICKLE-LOAD-HEURISTIC",
    "detected_by": "Heuristic"
  },
  {
    "id": "PY-PATH-TRAVERSAL-001",
    "file": "sample.zip/sample\\sample_python.py",
    "line": 11,
    "severity": "CRITICAL",
    "category": "Path Traversal",
    "message": "User input flows into file open \u2192 Path Traversal / Arbitrary File Read.",
    "suggestion": "Validate or whitelist filenames; prevent '..' or absolute paths.",
    "owasp": "",
    "cwe": "",
    "snippet": "with open(\"data.pkl\", \"rb\") as f:",
    "detected_by": "Context-AST"
  }
]