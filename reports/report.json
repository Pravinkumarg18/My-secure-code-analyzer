[
  {
    "id": "PHP-EVAL-001",
    "file": "uploads\\sample2.php",
    "line": 63,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "Use of eval() can lead to code injection.",
    "suggestion": "Avoid eval(); use safer alternatives.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "eval($_GET['code']);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\sample2.php",
    "line": 27,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "if (isset($_GET['ping'])) {",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\sample2.php",
    "line": 107,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "class Test { public $cmd; function __wakeup(){ system($this->cmd); } }",
    "detected_by": "AST"
  },
  {
    "id": "PHP-CRYPTO-001",
    "file": "uploads\\sample2.php",
    "line": 141,
    "severity": "MEDIUM",
    "category": "Weak Cryptography",
    "message": "Weak hash algorithm used.",
    "suggestion": "Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "$hash = md5($_POST['pwd']);",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-ERROR-LEAK-001",
    "file": "uploads\\sample2.php",
    "line": 104,
    "severity": "LOW",
    "category": "Error Handling",
    "message": "Leaking raw errors or phpinfo() reveals sensitive info.",
    "suggestion": "Log errors server-side and show generic error messages.",
    "owasp": "A09:2021-SecurityLoggingandMonitoringFailures",
    "cwe": "",
    "snippet": "phpinfo();",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-MYSQL-LEGACY-001",
    "file": "uploads\\sample2.php",
    "line": 20,
    "severity": "HIGH",
    "category": "Sql Injection",
    "message": "Use of deprecated mysql_* API with untrusted input allows SQL Injection.",
    "suggestion": "Migrate to mysqli or PDO with prepared statements.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "$res = mysql_query(\"SELECT * FROM users WHERE id=$id\"); // vuln: SQLi",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SQL-TAINT",
    "file": "uploads\\sample2.php",
    "line": 73,
    "severity": "CRITICAL",
    "category": "Sql Injection",
    "message": "User-controlled input flows into SQL query without sanitization.",
    "suggestion": "Use prepared statements (parameterized queries).",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-89",
    "snippet": "mysql_query(\"UPDATE users SET email='{$_POST['email']}' WHERE id=1\");",
    "detected_by": "Regex+AST(Taint)"
  },
  {
    "id": "PHP-MYSQL-LEGACY-001",
    "file": "uploads\\sample2.php",
    "line": 92,
    "severity": "HIGH",
    "category": "Sql Injection",
    "message": "Use of deprecated mysql_* API with untrusted input allows SQL Injection.",
    "suggestion": "Migrate to mysqli or PDO with prepared statements.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "mysql_query(\"INSERT INTO users (username, password) VALUES ('$u','$p')\");",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-INCLUDE-001",
    "file": "uploads\\sample2.php",
    "line": 32,
    "severity": "HIGH",
    "category": "File Inclusion",
    "message": "Dynamic include/require detected. May allow LFI/RFI.",
    "suggestion": "Never include user input in include/require paths. Use whitelists.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "if (isset($_GET['page'])) {",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-FILE-READ-001",
    "file": "uploads\\sample2.php",
    "line": 44,
    "severity": "HIGH",
    "category": "Path Traversal",
    "message": "file_get_contents on user input may allow path traversal / arbitrary file read.",
    "suggestion": "Avoid using unvalidated input in file_get_contents.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "echo file_get_contents(\"uploads/\" . $file);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-FILE-READ-001",
    "file": "uploads\\sample2.php",
    "line": 116,
    "severity": "HIGH",
    "category": "Path Traversal",
    "message": "file_get_contents on user input may allow path traversal / arbitrary file read.",
    "suggestion": "Avoid using unvalidated input in file_get_contents.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "$ctx = stream_context_create([\"ssl\"=>[\"verify_peer\"=>false]]);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-FILE-READ-001",
    "file": "uploads\\sample2.php",
    "line": 134,
    "severity": "HIGH",
    "category": "Path Traversal",
    "message": "file_get_contents on user input may allow path traversal / arbitrary file read.",
    "suggestion": "Avoid using unvalidated input in file_get_contents.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "$b = file_get_contents(\"balance.txt\");",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-UNSERIALIZE-AST-001",
    "file": "uploads\\sample2.php",
    "line": 68,
    "severity": "CRITICAL",
    "category": "Insecure Deserialization",
    "message": "unserialize() called in AST. Dangerous with untrusted input.",
    "suggestion": "Avoid unserialize(); prefer JSON or validate inputs.",
    "owasp": "A08:2021-SoftwareandDataIntegrityFailures",
    "cwe": "",
    "snippet": "$obj = unserialize($_POST['data']);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-UPLOAD-001",
    "file": "uploads\\sample2.php",
    "line": 38,
    "severity": "HIGH",
    "category": "Insecure File Upload",
    "message": "File upload without validation detected.",
    "suggestion": "Validate file type, size, extension; randomize name; store outside web root.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "move_uploaded_file($_FILES['file']['tmp_name'], \"uploads/\" . $_FILES['file']['name']);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-AUTH-CHECK-001",
    "file": "uploads\\sample2.php",
    "line": 101,
    "severity": "HIGH",
    "category": "Broken Access Control",
    "message": "Access control decision appears to be based on user input.",
    "suggestion": "Enforce server-side authorization using session or token checks.",
    "owasp": "A01:2021-BrokenAccessControl,A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "setcookie(\"auth\", $_GET['auth'] ?? \"none\");",
    "detected_by": "AST"
  },
  {
    "id": "PHP-SQLI-002",
    "file": "uploads\\sample2.php",
    "line": 72,
    "severity": "CRITICAL",
    "category": "Sql Injection",
    "message": "Potential SQL injection vulnerability",
    "suggestion": "Use prepared statements or parameterized queries. Validate all inputs.",
    "owasp": "A03:2021-Injection",
    "cwe": "CWE-89",
    "snippet": "if (isset($_POST['updateEmail'])) {",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-AUTH-CHECK-001",
    "file": "uploads\\sample2.php",
    "line": 83,
    "severity": "HIGH",
    "category": "Broken Access Control",
    "message": "Access control decision appears to be based on user input.",
    "suggestion": "Enforce server-side authorization using session or token checks.",
    "owasp": "A01:2021-BrokenAccessControl",
    "cwe": "",
    "snippet": "if ($_GET['user'] == $admin_user && $_GET['pass'] == $admin_pass) {",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-HARDCODED-SECRET-002",
    "file": "uploads\\sample2.php",
    "line": 110,
    "severity": "HIGH",
    "category": "Insecure Design",
    "message": "Hardcoded secret or token detected.",
    "suggestion": "Use environment variables or a secrets manager.",
    "owasp": "A04:2021-InsecureDesign",
    "cwe": "",
    "snippet": "$apiKey = \"SECRET-API-KEY-123\";",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-OUTDATED-MYSQL-001",
    "file": "uploads\\sample2.php",
    "line": 14,
    "severity": "HIGH",
    "category": "Outdated Components",
    "message": "Use of deprecated mysql_connect() detected.",
    "suggestion": "Migrate to PDO or mysqli with prepared statements.",
    "owasp": "A06:2021-VulnerableandOutdatedComponents",
    "cwe": "",
    "snippet": "$conn = mysql_connect(\"localhost\", \"root\", \"root\");",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SSRF-001",
    "file": "uploads\\sample2.php",
    "line": 117,
    "severity": "HIGH",
    "category": "Ssrf",
    "message": "Potential SSRF: fetching external URL without validation.",
    "suggestion": "Validate and whitelist remote URLs before requesting.",
    "owasp": "A10:2021-SSRF",
    "cwe": "",
    "snippet": "file_get_contents(\"https://untrusted-site.com/data\", false, $ctx);",
    "detected_by": "Regex"
  },
  {
    "id": "php-header-injection",
    "file": "uploads\\sample2.php",
    "line": 78,
    "severity": "HIGH",
    "category": "Injection",
    "message": "Unvalidated redirects via header() can lead to Open Redirect or CRLF Injection.",
    "suggestion": "Sanitize and validate redirect URLs. Use a fixed set of allowed destinations.",
    "owasp": "A01:2021-BrokenAccessControl",
    "cwe": "",
    "snippet": "header(\"Location: \" . $_GET['url']);",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-HEUR-023",
    "file": "uploads\\sample2.php",
    "line": 53,
    "severity": "LOW",
    "category": "Session Handling",
    "message": "Session start detected, ensure secure flags are set.",
    "suggestion": "Use secure session cookies (HttpOnly, Secure, SameSite).",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "session_start();",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-SYSTEM-AST-001",
    "file": "uploads\\sample2.php",
    "line": 28,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "system() detected in PHP AST; may allow command injection.",
    "suggestion": "Avoid system(); use safer built-in APIs.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "system(\"ping -c 1 \" . $_GET['ping']);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-INCLUDE-AST-001",
    "file": "uploads\\sample2.php",
    "line": 33,
    "severity": "HIGH",
    "category": "File Inclusion",
    "message": "Dynamic include/require detected.",
    "suggestion": "Never use user input in include/require paths. Use whitelists.",
    "owasp": "A05:2021-SecurityMisconfiguration",
    "cwe": "",
    "snippet": "include($_GET['page'] . \".php\");",
    "detected_by": "AST"
  }
]