[
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\deepseek_php.php",
    "line": 120,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// 11. Unsafe use of exec() with user input",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\deepseek_php.php",
    "line": 124,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// Unsafe execution of user input",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\deepseek_php.php",
    "line": 322,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "<li>exec - exec() Injection</li>",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-CRYPTO-001",
    "file": "uploads\\deepseek_php.php",
    "line": 54,
    "severity": "MEDIUM",
    "category": "Weak Cryptography",
    "message": "Weak hash algorithm used.",
    "suggestion": "Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "if (md5($password) === $stored_hash) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-CRYPTO-001",
    "file": "uploads\\deepseek_php.php",
    "line": 114,
    "severity": "MEDIUM",
    "category": "Weak Cryptography",
    "message": "Weak hash algorithm used.",
    "suggestion": "Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "if (md5($password) == $stored_hash) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-MT-RAND-001",
    "file": "uploads\\deepseek_php.php",
    "line": 163,
    "severity": "MEDIUM",
    "category": "Weak Randomness",
    "message": "Use of mt_rand() for security tokens is unsafe.",
    "suggestion": "Use random_int() or random_bytes() instead.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "$token = mt_rand(); // Not cryptographically secure",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SESSION-001",
    "file": "uploads\\deepseek_php.php",
    "line": 67,
    "severity": "MEDIUM",
    "category": "Session Management",
    "message": "Cookie set without Secure/HttpOnly/SameSite flags.",
    "suggestion": "Always set cookies with HttpOnly, Secure, and SameSite=strict.",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "setcookie(\"user_data\", base64_encode(serialize($_SESSION)), time()+3600, \"/\", \"\", false, false);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-HEUR-021",
    "file": "uploads\\deepseek_php.php",
    "line": 74,
    "severity": "MEDIUM",
    "category": "Superglobals",
    "message": "Use of PHP superglobal $_REQUEST detected.",
    "suggestion": "Use $_GET or $_POST explicitly and validate input.",
    "owasp": "A01:2021-BrokenAccessControl",
    "cwe": "",
    "snippet": "foreach ($_REQUEST as $key => $value) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-HEUR-023",
    "file": "uploads\\deepseek_php.php",
    "line": 64,
    "severity": "LOW",
    "category": "Session Handling",
    "message": "Session start detected, ensure secure flags are set.",
    "suggestion": "Use secure session cookies (HttpOnly, Secure, SameSite).",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "session_start();",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-EXEC-AST-001",
    "file": "uploads\\deepseek_php.php",
    "line": 125,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "exec() detected in PHP AST; may allow command injection.",
    "suggestion": "Avoid exec(); use safer built-in APIs.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "exec(\"ls -la \" . $command, $output);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-PREG-REPLACE-AST-001",
    "file": "uploads\\deepseek_php.php",
    "line": 147,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "preg_replace with /e modifier executes code \u2192 RCE risk.",
    "suggestion": "Use preg_replace_callback instead of /e.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "$result = preg_replace('/\\{(\\w+)\\}/e', '$data[\"$1\"]', $template);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\deepseek_php.php",
    "line": 120,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// 11. Unsafe use of exec() with user input",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\deepseek_php.php",
    "line": 124,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// Unsafe execution of user input",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\deepseek_php.php",
    "line": 322,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "<li>exec - exec() Injection</li>",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-CRYPTO-001",
    "file": "uploads\\deepseek_php.php",
    "line": 54,
    "severity": "MEDIUM",
    "category": "Weak Cryptography",
    "message": "Weak hash algorithm used.",
    "suggestion": "Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "if (md5($password) === $stored_hash) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-CRYPTO-001",
    "file": "uploads\\deepseek_php.php",
    "line": 114,
    "severity": "MEDIUM",
    "category": "Weak Cryptography",
    "message": "Weak hash algorithm used.",
    "suggestion": "Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "if (md5($password) == $stored_hash) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-MT-RAND-001",
    "file": "uploads\\deepseek_php.php",
    "line": 163,
    "severity": "MEDIUM",
    "category": "Weak Randomness",
    "message": "Use of mt_rand() for security tokens is unsafe.",
    "suggestion": "Use random_int() or random_bytes() instead.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "$token = mt_rand(); // Not cryptographically secure",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SESSION-001",
    "file": "uploads\\deepseek_php.php",
    "line": 67,
    "severity": "MEDIUM",
    "category": "Session Management",
    "message": "Cookie set without Secure/HttpOnly/SameSite flags.",
    "suggestion": "Always set cookies with HttpOnly, Secure, and SameSite=strict.",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "setcookie(\"user_data\", base64_encode(serialize($_SESSION)), time()+3600, \"/\", \"\", false, false);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-HEUR-021",
    "file": "uploads\\deepseek_php.php",
    "line": 74,
    "severity": "MEDIUM",
    "category": "Superglobals",
    "message": "Use of PHP superglobal $_REQUEST detected.",
    "suggestion": "Use $_GET or $_POST explicitly and validate input.",
    "owasp": "A01:2021-BrokenAccessControl",
    "cwe": "",
    "snippet": "foreach ($_REQUEST as $key => $value) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-HEUR-023",
    "file": "uploads\\deepseek_php.php",
    "line": 64,
    "severity": "LOW",
    "category": "Session Handling",
    "message": "Session start detected, ensure secure flags are set.",
    "suggestion": "Use secure session cookies (HttpOnly, Secure, SameSite).",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "session_start();",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-EXEC-AST-001",
    "file": "uploads\\deepseek_php.php",
    "line": 125,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "exec() detected in PHP AST; may allow command injection.",
    "suggestion": "Avoid exec(); use safer built-in APIs.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "exec(\"ls -la \" . $command, $output);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-PREG-REPLACE-AST-001",
    "file": "uploads\\deepseek_php.php",
    "line": 147,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "preg_replace with /e modifier executes code \u2192 RCE risk.",
    "suggestion": "Use preg_replace_callback instead of /e.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "$result = preg_replace('/\\{(\\w+)\\}/e', '$data[\"$1\"]', $template);",
    "detected_by": "AST"
  }
]