<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Secure Code Analyzer Report</title>
<style>
body { font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 16px; }
.downloads button { background:#1976d2; color:white; border:none; padding:8px 12px; margin-right:8px; border-radius:4px; cursor:pointer; }
.downloads button:hover { background:#1259a7; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { border: 1px solid #ddd; padding: 8px; font-size: 14px; }
th { background: #f7f7f7; position: sticky; top: 0; }
tr.row-critical { background: #e6ccff; }
tr.row-high { background: #fdecea; }
tr.row-medium { background: #fff8e1; }
tr.row-low { background: #e8f4fd; }
.sev-critical { background: #d1b3ff; color: #3d0066; }
.sev-high { background: #f8d7da; color: #721c24; }
.sev-medium { background: #fff3cd; color: #856404; }
.sev-low { background: #d1ecf1; color: #0c5460; }
.tag { display:inline-block; padding:2px 6px; border-radius: 3px; font-size: 12px; margin-top:2px; }
.owasp { background:#ffe6e6; color:#900; }
.cwe { background:#e6f0ff; color:#004080; }
.controls { display:flex; gap:12px; align-items:center; margin:10px 0; flex-wrap: wrap; }
</style>
<script>
function filterTable() {
  const severity = document.getElementById('sevFilter').value;
  const owasp = document.getElementById('owaspFilter').value;
  const cwe = document.getElementById('cweFilter').value;
  const q = document.getElementById('searchBox').value.toLowerCase();

  const tbody = document.getElementById('tbody');
  Array.from(tbody.rows).forEach(r => {
    const sev = r.querySelector('.sev').textContent.trim().toUpperCase();
    const text = r.textContent.toLowerCase();
    const ruleText = r.querySelector('.rule-cell').textContent;

    const okSev = (severity === 'ALL' || sev === severity);
    const okOwasp = (owasp === 'ALL' || ruleText.includes(owasp));
    const okCwe = (cwe === 'ALL' || ruleText.includes(cwe));
    const okSearch = text.includes(q);

    r.style.display = (okSev && okOwasp && okCwe && okSearch) ? '' : 'none';
  });
}

function downloadContent(filename, content, type) {
  const blob = new Blob([content], {type});
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
function downloadJSON() {
  const content = `[
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 120,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// 11. Unsafe use of exec() with user input",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 124,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "// Unsafe execution of user input",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SYSTEM-EXEC-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 322,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "Command execution can lead to injection if args are tainted.",
    "suggestion": "Avoid shell execution; use built-in APIs and strict validation.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "<li>exec - exec() Injection</li>",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-CRYPTO-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 54,
    "severity": "MEDIUM",
    "category": "Weak Cryptography",
    "message": "Weak hash algorithm used.",
    "suggestion": "Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "if (md5($password) === $stored_hash) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-CRYPTO-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 114,
    "severity": "MEDIUM",
    "category": "Weak Cryptography",
    "message": "Weak hash algorithm used.",
    "suggestion": "Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "if (md5($password) == $stored_hash) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-MT-RAND-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 163,
    "severity": "MEDIUM",
    "category": "Weak Randomness",
    "message": "Use of mt_rand() for security tokens is unsafe.",
    "suggestion": "Use random_int() or random_bytes() instead.",
    "owasp": "A02:2021-CryptographicFailures",
    "cwe": "",
    "snippet": "$token = mt_rand(); // Not cryptographically secure",
    "detected_by": "Regex"
  },
  {
    "id": "PHP-SESSION-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 67,
    "severity": "MEDIUM",
    "category": "Session Management",
    "message": "Cookie set without Secure/HttpOnly/SameSite flags.",
    "suggestion": "Always set cookies with HttpOnly, Secure, and SameSite=strict.",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "setcookie(\\"user_data\\", base64_encode(serialize($_SESSION)), time()+3600, \\"/\\", \\"\\", false, false);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-HEUR-021",
    "file": "uploads\\\\deepseek_php.php",
    "line": 74,
    "severity": "MEDIUM",
    "category": "Superglobals",
    "message": "Use of PHP superglobal $_REQUEST detected.",
    "suggestion": "Use $_GET or $_POST explicitly and validate input.",
    "owasp": "A01:2021-BrokenAccessControl",
    "cwe": "",
    "snippet": "foreach ($_REQUEST as $key => $value) {",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-HEUR-023",
    "file": "uploads\\\\deepseek_php.php",
    "line": 64,
    "severity": "LOW",
    "category": "Session Handling",
    "message": "Session start detected, ensure secure flags are set.",
    "suggestion": "Use secure session cookies (HttpOnly, Secure, SameSite).",
    "owasp": "A07:2021-IdentificationandAuthenticationFailures",
    "cwe": "",
    "snippet": "session_start();",
    "detected_by": "Heuristic"
  },
  {
    "id": "PHP-EXEC-AST-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 125,
    "severity": "HIGH",
    "category": "Command Execution",
    "message": "exec() detected in PHP AST; may allow command injection.",
    "suggestion": "Avoid exec(); use safer built-in APIs.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "exec(\\"ls -la \\" . $command, $output);",
    "detected_by": "AST"
  },
  {
    "id": "PHP-PREG-REPLACE-AST-001",
    "file": "uploads\\\\deepseek_php.php",
    "line": 147,
    "severity": "HIGH",
    "category": "Dangerous Function",
    "message": "preg_replace with /e modifier executes code \\u2192 RCE risk.",
    "suggestion": "Use preg_replace_callback instead of /e.",
    "owasp": "A03:2021-Injection",
    "cwe": "",
    "snippet": "$result = preg_replace('/\\\\{(\\\\w+)\\\\}/e', '$data[\\"$1\\"]', $template);",
    "detected_by": "AST"
  }
]`;
  downloadContent("report.json", content, "application/json");
}
function downloadHTML() {
  const content = document.documentElement.outerHTML;
  downloadContent("report.html", content, "text/html");
}
</script>
</head>
<body>
<h1>Secure Code Analyzer Report</h1>
<small>Generated at: 2025-09-05 07:33:17 UTC</small>

<div class="downloads">
  <button onclick="downloadJSON()">⬇ Download JSON</button>
  <button onclick="downloadHTML()">⬇ Download HTML</button>
</div>

<div class="controls">
  <label>Severity:
    <select id="sevFilter" onchange="filterTable()">
      <option value="ALL" selected>All</option>
      <option value="CRITICAL">Critical</option>
      <option value="HIGH">High</option>
      <option value="MEDIUM">Medium</option>
      <option value="LOW">Low</option>
    </select>
  </label>
  <label>OWASP:
    <select id="owaspFilter" onchange="filterTable()">
      <option value="ALL" selected>All</option>
      <option value='A01:2021-BrokenAccessControl'>A01:2021-BrokenAccessControl</option><option value='A02:2021-CryptographicFailures'>A02:2021-CryptographicFailures</option><option value='A03:2021-Injection'>A03:2021-Injection</option><option value='A07:2021-IdentificationandAuthenticationFailures'>A07:2021-IdentificationandAuthenticationFailures</option>
    </select>
  </label>
  <label>CWE:
    <select id="cweFilter" onchange="filterTable()">
      <option value="ALL" selected>All</option>
      
    </select>
  </label>
  <label>Search:
    <input id="searchBox" type="text" placeholder="Search issues..." oninput="filterTable()"/>
  </label>
</div>

<table>
  <thead>
    <tr>
      <th>File</th><th>Line</th><th>Severity</th>
      <th>Category</th><th>Rule / Mapping</th>
      <th>Message</th><th>Snippet</th>
      <th>Suggestion</th><th>Detected By</th>
    </tr>
  </thead>
  <tbody id="tbody">
    
          <tr class="row-high">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">120</td>
            <td><span class="sev sev-high">HIGH</span></td>
            <td>Command Execution</td>
            <td class="rule-cell">PHP-SYSTEM-EXEC-001<br><span class='tag owasp'>A03:2021-Injection</span></td>
            <td>Command execution can lead to injection if args are tainted</td>
            <td><code>// 11. Unsafe use of exec() with user input</code></td>
            <td>Avoid shell execution; use built-in APIs and strict validation</td>
            <td>Regex</td>
          </tr>
        
          <tr class="row-high">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">124</td>
            <td><span class="sev sev-high">HIGH</span></td>
            <td>Command Execution</td>
            <td class="rule-cell">PHP-SYSTEM-EXEC-001<br><span class='tag owasp'>A03:2021-Injection</span></td>
            <td>Command execution can lead to injection if args are tainted</td>
            <td><code>// Unsafe execution of user input</code></td>
            <td>Avoid shell execution; use built-in APIs and strict validation</td>
            <td>Regex</td>
          </tr>
        
          <tr class="row-high">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">322</td>
            <td><span class="sev sev-high">HIGH</span></td>
            <td>Command Execution</td>
            <td class="rule-cell">PHP-SYSTEM-EXEC-001<br><span class='tag owasp'>A03:2021-Injection</span></td>
            <td>Command execution can lead to injection if args are tainted</td>
            <td><code>&lt;li&gt;exec - exec() Injection&lt;/li&gt;</code></td>
            <td>Avoid shell execution; use built-in APIs and strict validation</td>
            <td>Regex</td>
          </tr>
        
          <tr class="row-medium">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">54</td>
            <td><span class="sev sev-medium">MEDIUM</span></td>
            <td>Weak Cryptography</td>
            <td class="rule-cell">PHP-CRYPTO-001<br><span class='tag owasp'>A02:2021-CryptographicFailures</span></td>
            <td>Weak hash algorithm used</td>
            <td><code>if (md5($password) === $stored_hash) {</code></td>
            <td>Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes</td>
            <td>Heuristic</td>
          </tr>
        
          <tr class="row-medium">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">114</td>
            <td><span class="sev sev-medium">MEDIUM</span></td>
            <td>Weak Cryptography</td>
            <td class="rule-cell">PHP-CRYPTO-001<br><span class='tag owasp'>A02:2021-CryptographicFailures</span></td>
            <td>Weak hash algorithm used</td>
            <td><code>if (md5($password) == $stored_hash) {</code></td>
            <td>Use password_hash (bcrypt/argon2) or sodium/openssl strong hashes</td>
            <td>Heuristic</td>
          </tr>
        
          <tr class="row-medium">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">163</td>
            <td><span class="sev sev-medium">MEDIUM</span></td>
            <td>Weak Randomness</td>
            <td class="rule-cell">PHP-MT-RAND-001<br><span class='tag owasp'>A02:2021-CryptographicFailures</span></td>
            <td>Use of mt_rand() for security tokens is unsafe</td>
            <td><code>$token = mt_rand(); // Not cryptographically secure</code></td>
            <td>Use random_int() or random_bytes() instead</td>
            <td>Regex</td>
          </tr>
        
          <tr class="row-medium">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">67</td>
            <td><span class="sev sev-medium">MEDIUM</span></td>
            <td>Session Management</td>
            <td class="rule-cell">PHP-SESSION-001<br><span class='tag owasp'>A07:2021-IdentificationandAuthenticationFailures</span></td>
            <td>Cookie set without Secure/HttpOnly/SameSite flags</td>
            <td><code>setcookie(&quot;user_data&quot;, base64_encode(serialize($_SESSION)), time()+3600, &quot;/&quot;, &quot;&quot;, false, false);</code></td>
            <td>Always set cookies with HttpOnly, Secure, and SameSite=strict</td>
            <td>AST</td>
          </tr>
        
          <tr class="row-medium">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">74</td>
            <td><span class="sev sev-medium">MEDIUM</span></td>
            <td>Superglobals</td>
            <td class="rule-cell">PHP-HEUR-021<br><span class='tag owasp'>A01:2021-BrokenAccessControl</span></td>
            <td>Use of PHP superglobal $_REQUEST detected</td>
            <td><code>foreach ($_REQUEST as $key =&gt; $value) {</code></td>
            <td>Use $_GET or $_POST explicitly and validate input</td>
            <td>Heuristic</td>
          </tr>
        
          <tr class="row-low">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">64</td>
            <td><span class="sev sev-low">LOW</span></td>
            <td>Session Handling</td>
            <td class="rule-cell">PHP-HEUR-023<br><span class='tag owasp'>A07:2021-IdentificationandAuthenticationFailures</span></td>
            <td>Session start detected, ensure secure flags are set</td>
            <td><code>session_start();</code></td>
            <td>Use secure session cookies (HttpOnly, Secure, SameSite)</td>
            <td>Heuristic</td>
          </tr>
        
          <tr class="row-high">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">125</td>
            <td><span class="sev sev-high">HIGH</span></td>
            <td>Command Execution</td>
            <td class="rule-cell">PHP-EXEC-AST-001<br><span class='tag owasp'>A03:2021-Injection</span></td>
            <td>exec() detected in PHP AST; may allow command injection</td>
            <td><code>exec(&quot;ls -la &quot; . $command, $output);</code></td>
            <td>Avoid exec(); use safer built-in APIs</td>
            <td>AST</td>
          </tr>
        
          <tr class="row-high">
            <td>uploads\deepseek_php.php</td>
            <td style="text-align:right">147</td>
            <td><span class="sev sev-high">HIGH</span></td>
            <td>Dangerous Function</td>
            <td class="rule-cell">PHP-PREG-REPLACE-AST-001<br><span class='tag owasp'>A03:2021-Injection</span></td>
            <td>preg_replace with /e modifier executes code → RCE risk</td>
            <td><code>$result = preg_replace(&#x27;/\{(\w+)\}/e&#x27;, &#x27;$data[&quot;$1&quot;]&#x27;, $template);</code></td>
            <td>Use preg_replace_callback instead of /e</td>
            <td>AST</td>
          </tr>
        
  </tbody>
</table>
</body>
</html>
